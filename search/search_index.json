{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"About","text":"<p>Windows Enterprise Defaults is designed to customize Windows images, replacing Microsoft defaults to make them enterprise-ready. While Microsoft's defaults cater to a broad range of users\u2014from individuals to enterprises\u2014an optimized enterprise desktop requires tailored adjustments.</p> <p>This solution streamlines modifications to Windows by updating the default profile, Start menu, taskbar, user environment, and Explorer settings. It also manages Windows capabilities, features, and removes certain in-box application packages.</p> <p>Windows Enterprise Defaults is not a \"de-bloater\", instead it focuses on making thoughtful changes without compromising the end-user experience. Though it removes some in-box applications and features, it ensures usability remains intact.</p> <p>Supporting Windows 10, Windows 11, and Windows Server 2016\u20132025, this tool works for both physical PCs and virtual machines (e.g., Azure Virtual Desktop, Windows 365). While primarily aimed at provisioning gold images for PCs or virtual desktops, it can also be applied to Windows Server infrastructure roles.</p> <p>To see the improved end-user experience, check out the Results page.</p>"},{"location":"#usage","title":"Usage","text":"<p>The solution is intended for operating system deployment via various methods, including:</p> <ul> <li>Imported into the Microsoft Deployment Toolkit as an application for use during Lite Touch deployments - Create a New Application in the Deployment Workbench</li> <li>Imported into Configuration Manager for use during Zero Touch deployments: - Create applications in Configuration Manager</li> <li>Packaged as a Win32 application and delivered via Microsoft Intune during Windows Autopilot - Win32 app management in Microsoft Intune</li> <li>Executed in a virtual machine image pipeline using Azure Image Builder or Packer when building a gold image</li> <li>Or even run manually on a Windows PC or virtual machine gold image if you're not using automation at all</li> </ul>"},{"location":"#supported-platforms","title":"Supported Platforms","text":"<p>Windows Enterprise Defaults has been tested on Windows 10 (1809 and above), Windows 11, Windows Server 2016-2025. All scripts should work on any future versions of Windows; however, you should test thoroughly before deployment in production.</p> <p>Windows PowerShell only is supported - typically during operating system deployments, there should be no strict requirement for PowerShell 6 or above. While the solution should work OK on PowerShell 6+, no testing is done on those versions.</p> <p>Laptop Settings by Icons8.</p>"},{"location":"appxapps/","title":"Remove Universal Windows Platform / AppX apps","text":"<p><code>Remove-AppxApps.ps1</code> will remove Universal Windows Platform (UWP) / Microsoft Store apps from the local Windows OS. This script runs in two modes:</p>"},{"location":"appxapps/#safe-package-list","title":"Safe Package List","text":"<p>In this default mode, the script includes an explicit list of applications that it will keep, including packages that cannot be removed or are frameworks (packages that support other applications). All other application packages will be removed.</p> <p>This mode should be run in Windows OOBE (1) (i.e. via Windows Autopilot or Device provisioning) or in a gold image, where the intention it to optimise the Windows installation by keeping only a core set of applications that provide valuable features to end-users.</p> <ol> <li>Windows OOBE stands for Windows Out-of-Box Experience. It's the setup process that occurs when you turn on a new Windows device for the first time or after resetting it to its factory settings. During OOBE, you're guided through various steps to personalize and configure your device, such as: connecting to a Wi-Fi network, setting up device preferences like region, keyboard layout, and privacy settings, and signing in with a Microsoft account.</li> </ol> <p>This allows you to optimise a Windows install or gold image by removing all but a specified list of AppX packages from the the local system to prevent new installs of unwanted apps when new users log onto the system.</p> <p>Warning</p> <p>It is not recommended to run this script on existing Windows PCs, as it will likely remove applications that users are actively using.</p>"},{"location":"appxapps/#default-packages","title":"Default Packages","text":"<p>This table lists the default packages that will be kept when <code>Remove-AppxApps.ps1</code>, all other packages will be removed.</p> PackageFamilyName Description Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe Enable basic notes functionality. Supports Microsoft 365 accounts Microsoft.Paint_8wekyb3d8bbwe Provides basic image editing functionality Microsoft.PowerAutomateDesktop_8wekyb3d8bbwe Desktop automation tool Microsoft.ScreenSketch_8wekyb3d8bbwe Capture and annotate screenshots Microsoft.Windows.Photos_8wekyb3d8bbwe Basic image viewing. Supports Microsoft 365 accounts Microsoft.WindowsAlarms_8wekyb3d8bbwe Clock app with timers, alarms,\u00a0\u00a0and world clock. Supports Microsoft 365 accounts Microsoft.WindowsCalculator_8wekyb3d8bbwe Calculator app Microsoft.WindowsNotepad_8wekyb3d8bbwe Notepad app Microsoft.WindowsSoundRecorder_8wekyb3d8bbwe Voice recording app Microsoft.WindowsTerminal_8wekyb3d8bbwe Essential terminal app Microsoft.MicrosoftEdge.Stable_8wekyb3d8bbwe Microsoft Edge browser Microsoft.ZuneMusic_8wekyb3d8bbwe Windows Media Player,\u00a0\u00a0video and music player Microsoft.WindowsStore_8wekyb3d8bbwe System package, could affect functionality if removed Microsoft.DesktopAppInstaller_8wekyb3d8bbwe System package, could affect functionality if removed Microsoft.ApplicationCompatibilityEnhancements_8wekyb3d8bbwe System package, could affect functionality if removed Microsoft.StorePurchaseApp_8wekyb3d8bbwe System package, could affect functionality if removed Microsoft.Wallet_8wekyb3d8bbwe System package, could affect functionality if removed MicrosoftWindows.CrossDevice_cw5n1h2txyewy System package, could affect functionality if removed MicrosoftWindows.Client.WebExperience_cw5n1h2txyewy System package, could affect functionality if removed Microsoft.WidgetsPlatformRuntime_8wekyb3d8bbwe System package, could affect functionality if removed MicrosoftCorporationII.WinAppRuntime.Main.1.5_8wekyb3d8bbwe System package, could affect functionality if removed MicrosoftCorporationII.WinAppRuntime.Singleton_8wekyb3d8bbwe System package, could affect functionality if removed Microsoft.MPEG2VideoExtension_8wekyb3d8bbwe Video codec Microsoft.AV1VideoExtension_8wekyb3d8bbwe Video codec Microsoft.AVCEncoderVideoExtension_8wekyb3d8bbwe Video codec Microsoft.HEIFImageExtension_8wekyb3d8bbwe Image codec Microsoft.HEVCVideoExtension_8wekyb3d8bbwe Video codec Microsoft.RawImageExtension_8wekyb3d8bbwe Image codec Microsoft.VP9VideoExtensions_8wekyb3d8bbwe Video codec Microsoft.WebMediaExtensions_8wekyb3d8bbwe Image codec Microsoft.WebpImageExtension_8wekyb3d8bbwe Image codec"},{"location":"appxapps/#targeted-package-list","title":"Targeted Package List","text":"<p>In the targeted mode, the script will remove a list of specified AppX packages, rather than any package except those specified. This mode is useful for running on an existing machine - e.g. existing Windows PCs managed with Intune, or used in a Windows feature upgrade.</p>"},{"location":"appxapps/#validate-package-removal","title":"Validate Package Removal","text":"<p><code>Remove-AppxApps.ps1</code> supports the <code>-WhatIf</code> parameter, so that you can see which packages will be removed from the local machine before running the script without the <code>-WhatIf</code> parameter.</p> <p></p>"},{"location":"appxapps/#parameters","title":"Parameters","text":""},{"location":"appxapps/#safepackagelist","title":"SafePackageList","text":"<p>An optional parameter that specifies a list of AppX package family names to be preserved during the removal process.</p>"},{"location":"appxapps/#targeted","title":"Targeted","text":"<p>An optional switch parameter that, when specified, runs the script with a targeted list of AppX packages to be removed.</p>"},{"location":"appxapps/#targetedpackagelist","title":"TargetedPackageList","text":"<p>An optional parameter that specifies a targeted list of AppX package family names to be removed when the -Targeted switch is used.</p>"},{"location":"appxapps/#examples","title":"Examples","text":""},{"location":"appxapps/#example-1","title":"Example 1","text":"<p>Remove all applications in the current Windows installation except for the default list of applications listed in <code>-SafePackages</code>, are non-removable or are package frameworks.</p> <pre><code>PS C:\\&gt; .\\Remove-AppxApps.ps1\n</code></pre> <p>Remove all applications in the current Windows installation except for those applications passed to <code>-SafePackages</code>, are non-removable or are package frameworks.</p> <pre><code>$Packages = @(\n        \"Microsoft.ScreenSketch_8wekyb3d8bbwe\",\n        \"Microsoft.WindowsCalculator_8wekyb3d8bbwe\",\n        \"Microsoft.WindowsNotepad_8wekyb3d8bbwe\",\n        \"Microsoft.WindowsTerminal_8wekyb3d8bbwe\",\n        \"Microsoft.MicrosoftEdge.Stable_8wekyb3d8bbwe\",\n        \"Microsoft.WindowsStore_8wekyb3d8bbwe\",\n        \"Microsoft.DesktopAppInstaller_8wekyb3d8bbwe\",\n        \"Microsoft.ApplicationCompatibilityEnhancements_8wekyb3d8bbwe\",\n        \"Microsoft.StorePurchaseApp_8wekyb3d8bbwe\",\n        \"Microsoft.Wallet_8wekyb3d8bbwe\",\n        \"MicrosoftWindows.CrossDevice_cw5n1h2txyewy\",\n        \"MicrosoftWindows.Client.WebExperience_cw5n1h2txyewy\",\n        \"Microsoft.WidgetsPlatformRuntime_8wekyb3d8bbwe\")\nPS C:\\&gt; .\\Remove-AppxApps.ps1 -SafePackages $Packages\n</code></pre>"},{"location":"appxapps/#example-2","title":"Example 2","text":"<p>Remove a set of applications in the current Windows installation listed in <code>-TargetedPackageList</code>.</p> <pre><code>PS C:\\&gt; .\\Remove-AppxApps.ps1 -Targeted\n</code></pre>"},{"location":"configs/","title":"Configurations","text":"<p>Configuration changes are implemented with <code>Install-Defaults.ps1</code>. This script reads configurations in JSON format and configures the local Windows instance with Windows feature states, registry settings, copies files into specified paths, imports a default Start menu, and modifies the default user profile.</p> <p>Configurations are stored in the following JSON files with the logic to make changes to Windows includes in <code>Install-Defaults.ps1</code>:</p> <ul> <li>Build.All.json</li> <li>Machine-Windows11.All.json</li> <li>Machine.All.json</li> <li>Machine.Client.json</li> <li>Machine.Server.json</li> <li>User-Windows10.All.json</li> <li>User-Windows11.All.json</li> <li>User.All.json</li> <li>User.Client.json</li> <li>User.Server.json</li> <li>User.Virtual.json</li> </ul> <p>JSON files are gathered based on properties of the local Windows instance. The following keywords, used in the file names, ensure that the right JSON files are selected:</p> <ul> <li><code>Client</code> - Windows 10 or Windows 11</li> <li><code>Server</code> - Windows Server 2016, 2019, 2022, 2025 etc.</li> <li><code>Virtual</code> - Virtual machines, e.g. Hyper-V, Azure, vSphere, Parallels etc.</li> <li><code>All</code> - applies to all Windows install types</li> </ul> <p>Each JSON file includes a <code>MinimumBuild</code> property that can be used to ensure specific configurations only apply to a specific version of Windows or above. For example, the property might ensure that configurations only apply to Windows 10 version <code>10.0.19041</code> and above.</p>"},{"location":"configs/#other-configurations","title":"Other Configurations","text":"<p><code>Install-Defaults.ps1</code> performs additional tasks not defined in the JSON configuration files:</p> <ul> <li>Removes inbox Universal Windows Platform (AppX) apps - see Remove UWP apps</li> <li>Copies the solution as a Run custom actions during feature update. This enables the Custom Defaults to be re-run during an in-place upgrade</li> </ul>"},{"location":"configs/#script-process-visualisation","title":"Script Process Visualisation","text":"<p>Here's an visualisation of how the <code>Install-Defaults.ps1</code> works:</p> <pre><code>graph TD\n    A[Invoke Install-Defaults.ps1] --&gt;B(Get OS platform)\n    B --&gt; C(Get OS version)\n    C --&gt; D(Get hardware model)\n    D --&gt; E(Gather .json configs)\n    E --&gt;|All| F[Install configs for all platforms]\n    E --&gt;|Platform| G[Install configs for target OS] --&gt;J\n    E --&gt;|Build| H[Install configs for OS version] --&gt;J\n    E --&gt;|Model| I[Install configs for hardware model] --&gt;J\n    F --&gt; J{Client OS?}\n    J --&gt;|Yes| K[Remove AppX apps]\n    J --&gt; L[Copy project files to feature update path]\n    L --&gt; M[Write uninstall info to registry]\n    K --&gt; N{Language specified?}\n    N --&gt;|Yes|O[Install &amp; set default language]</code></pre>"},{"location":"custom/","title":"Customise","text":"<p>To customise the solution, download the latest release in <code>.zip</code> format and extract the archive. You should then see a folder listing similar to the following.</p> <p></p> <p>In most cases, you may want to customise the default Start menu; however, you may also have a requirement to add or remove registry settings.</p>"},{"location":"custom/#registry-settings","title":"Registry settings","text":"<p>Registry settings should be laid out in the following format:</p> <pre><code>{\n    \"MinimumBuild\": \"10.0.14393\",\n    \"Registry\": {\n        \"Type\": \"DefaultProfile\",\n        \"Set\": [\n            {\n                \"path\": \"HKCU:\\\\Software\\\\Microsoft\\\\TabletTip\\\\1.7\",\n                \"name\": \"TipbandDesiredVisibility\",\n                \"value\": 0,\n                \"type\": \"DWord\"\n            }\n        ]\n    }\n}\n</code></pre> <p>Settings and values that can be used here are:</p> <ul> <li><code>MinimumBuild</code> - used to ensure that the specified registry settings are only implemented if the Windows instance is equal to or greater than the specified version number</li> <li><code>Registry</code> - a required property</li> <li><code>Type</code> - this property supports <code>DefaultProfile</code> or <code>Direct</code>, tell the solution to implement the array of registry entries listed in <code>Set</code> to be applied directly against the path specified or the the default profile</li> <li><code>Set</code> - tells the solution to set the array of registry entries</li> </ul> <p>Each registry entry must include <code>path</code>, <code>name</code>, <code>value</code> and <code>type</code>. The Type property are registry entry types that are expected by <code>Set-ItemProperty</code>.</p>"},{"location":"custom/#registry-paths","title":"Registry paths","text":"<p>Registry paths can be specified with <code>HKLM:</code> or <code>HKCU:</code>. Registry entries with paths in <code>HKLM</code> should not be included with the <code>Type</code> property set to <code>DefaultProfile</code>.</p>"},{"location":"custom/#files-and-folders","title":"Files and Folders","text":"<p>The solution supports the removal of target directories and coping of files into a target directory.</p> <pre><code>{\n    \"MinimumBuild\": \"10.0.14393\",\n    \"Paths\": {\n        \"Remove\": [\n            \"C:\\\\Users\\\\Public\\\\Music\\\\Sample Music\",\n            \"C:\\\\Users\\\\Public\\\\Pictures\\\\Sample Pictures\",\n            \"C:\\\\Users\\\\Public\\\\Videos\\\\Sample Videos\",\n            \"C:\\\\Users\\\\Public\\\\Recorded TV\\\\Sample Media\",\n            \"C:\\\\Logs\"\n        ],\n        \"Copy\": [\n            {\n                \"Source\": \"desktop-config.json\",\n                \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Roaming\\\\Microsoft\\\\Teams\"\n            }\n        ]\n    }\n}\n</code></pre> <p>Settings and values that can be used here are:</p> <ul> <li><code>MinimumBuild</code> - used to ensure that the specified file or folder actions are only implemented if the Windows instance is equal to or greater than the specified version number</li> <li><code>Remove</code> - specified an array of paths to remove from the image if the path exists</li> <li><code>Copy</code> - specifies an array of source and destination paths. The source must be located within the solution's source directory.</li> </ul>"},{"location":"custom/#enabling-services","title":"Enabling Services","text":"<p>The solution can enable services if a dependent feature exists. For example, the following snippet will enable the Windows Audio and Windows Search services if the Remote Desktop Session Host feature exists.</p> <pre><code>{\n    \"MinimumBuild\": \"10.0.14393\",\n    \"Services\": {\n        \"Feature\": \"RDS-RD-Server\",\n        \"Enable\": [\n            \"Audiosrv\",\n            \"WSearch\"\n        ]\n    }\n}\n</code></pre>"},{"location":"custom/#windows-features","title":"Windows Features","text":"<p>Windows feature states can be configured using the following JSON:</p> <pre><code>{\n    \"MinimumBuild\": \"10.0.14393\",\n    \"Features\": {\n        \"Disable\": [\n            \"Printing-XPSServices-Features\",\n            \"SMB1Protocol\",\n            \"WorkFolders-Client\",\n            \"FaxServicesClientPackage\",\n            \"WindowsMediaPlayer\"\n        ]\n    },\n    \"Capabilities\": {\n        \"Remove\": [\n            \"App.Support.QuickAssist~~~~0.0.1.0\",\n            \"Media.WindowsMediaPlayer~~~~0.0.12.0\",\n            \"XPS.Viewer~~~~0.0.1.0\"\n        ],\n    },\n    \"Packages\": {\n        \"Remove\": [\n            \"Microsoft-Windows-MediaPlayer-Package*\"\n        ]\n    }\n}\n</code></pre> <ul> <li><code>MinimumBuild</code> - used to ensure that the specified file or folder actions are only implemented if the Windows instance is equal to or greater than the specified version number</li> <li><code>Features / Disable</code> - disables Windows features. Accepts feature names retrieved with <code>Get-WindowsOptionalFeature -Online</code></li> <li><code>Capabilities / Remove</code> - removes Windows capabilities. Accepts capability names retrieved with <code>Get-WindowsCapability -Online</code></li> <li><code>Packages / Remove</code> - removes Windows packages. Accepts package names retrieved with <code>Get-WindowsPackage -Online</code></li> </ul>"},{"location":"custom/#start-menu-and-taskbar","title":"Start menu and Taskbar","text":"<p>Importing a default Start menu is implemented with the following JSON; however, note that there are differences between client and server versions of Windows.</p> <p>For Windows 10 or Windows 11, the Start menu layout to import, is specified with the <code>Windows10</code> or <code>Windows11</code> property; while for Windows Server, the Start menu layout is specified by the presence or not of a specified Windows feature - in the example below a specific layout is imported is the Remote Desktop Session Host role is installed.</p> ClientServer <pre><code>{\n    \"MinimumBuild\": \"10.0.14393\",\n    \"StartMenu\": {\n        \"Type\": \"Client\",\n        \"Feature\": \"\",\n        \"Windows10\": [\n            {\n                \"Source\": \"Windows10StartMenuLayout.xml\",\n                \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.xml\"\n            }\n        ],\n        \"Windows11\": [\n            {\n                \"Source\": \"Windows11StartMenuLayout.json\",\n                \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.json\"\n            },\n            {\n                \"Source\": \"Windows11TaskbarLayout.xml\",\n                \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.xml\"\n            },\n            {\n                \"Source\": \"Windows11Start.bin\",\n                \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Packages\\\\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\\\\LocalState\\\\start2.bin\"\n            }\n        ]\n    }\n}\n</code></pre> <pre><code>{\n    \"StartMenu\": {\n        \"Type\": \"Server\",\n        \"Feature\": \"RDS-RD-Server\",\n        \"Exists\": [\n            {\n                \"Source\": \"WindowsRDSStartMenuLayout.xml\",\n                \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.xml\"\n            }\n        ],\n        \"NotExists\": [\n            {\n                \"Source\": \"WindowsServerStartMenuLayout.xml\",\n                \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.xml\"\n            }\n        ]\n    }\n}\n</code></pre>"},{"location":"custom/#windows-11-start-menu","title":"Windows 11 Start menu","text":"<p>Importing a customised default Start menu for Windows 10 and current versions of Windows Server works by importing LayoutModification.xml; however this process is changed considerably for Windows 11 and it does not provide you full control over the default layout, particularly the pinned shortcuts.</p> <p>For example, you won't be able to remove the Microsoft Store shortcut from the Windows 11 Start menu. Therefore, if you want a full customised default Start menu, another approach is required.</p> <p>The use of <code>LayoutModification.json</code> and <code>LayoutModification.xml</code> to customise the Start menu and the Taskbar respectively can be used; however, to fully customise all shortcuts pinned to the Windows 11 Start menu, the StartMenuExperienceHost persistent state (<code>start2.bin</code>) must be copied from a source machine. The file is found in <code>%LocalAppData%\\Packages\\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\\LocalState</code>.</p> <p>The solution includes a persistent state file - <code>Windows11Start.bin</code>, in addition to <code>LayoutModification.json</code> and <code>LayoutModification.xml</code>. These will all be copied into the appropriate destination as specified in the JSON:</p> <pre><code>\"Windows11\": [\n    {\n        \"Source\": \"Windows11StartMenuLayout.json\",\n        \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.json\"\n    },\n    {\n        \"Source\": \"Windows11TaskbarLayout.xml\",\n        \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.xml\"\n    },\n    {\n        \"Source\": \"Windows11Start.bin\",\n        \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Packages\\\\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\\\\LocalState\\\\start2.bin\"\n    }\n]\n</code></pre>"},{"location":"feature/","title":"Feature upgrades","text":"<p>Windows Enterprise Defaults supports running as a custom action at the end of a successful Windows feature upgrade - Run custom actions during feature update.</p> <p>When <code>Install-Defaults.ps1</code> runs, it copies the project files to <code>C:\\WINDOWS\\System32\\update\\run\\f38de27b-799e-4c30-8a01-bfdedc622944</code>. This enables the solution to be re-run after the feature update is complete and ensure the desired system configuration is maintained. </p> <p></p> <p>When a feature upgrade completes (e.g. Windows 11 23H2 to Windows 11 24H2), <code>success.cmd</code> is executed. This will re-run <code>Install-Defaults.ps1</code> and explicitly run <code>Remove-AppxApps.ps1</code> in targeted mode. This removes a set of AppX applications that are often reinstalled during a feature update.</p> <pre><code>@ECHO OFF\nSET SOURCE=C:\\WINDOWS\\System32\\update\\run\\f38de27b-799e-4c30-8a01-bfdedc622944\n%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -WindowStyle Hidden -File \"%SOURCE%\\Remove-AppxApps.ps1\" -Targeted\n%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -WindowStyle Hidden -File \"%SOURCE%\\Install-Defaults.ps1\" -Path \"%SOURCE%\"\n</code></pre>"},{"location":"features/","title":"Removed Capabilities and Features","text":""},{"location":"features/#buildalljson","title":"Build.All.json","text":"<p>Windows capabilities to remove on all Windows versions.</p> Minimum build Maximum build 10.0.19041 10.0.99999 Capability Microsoft.Windows.WordPad<sub>~</sub>~0.0.1.0 Print.Fax.Scan<sub>~</sub>~0.0.1.0 Print.Management.Console<sub>~</sub>~0.0.1.0"},{"location":"features/#machinealljson","title":"Machine.All.json","text":"<p>Computer level settings for all Windows 10 and above.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct Capability Media.WindowsMediaPlayer<sub>~</sub>~0.0.12.0 XPS.Viewer<sub>~</sub>~0.0.1.0"},{"location":"features/#machinealljson_1","title":"Machine.All.json","text":"<p>Computer level settings for all Windows 10 and above.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct Feature Printing-XPSServices-Features SMB1Protocol WorkFolders-Client FaxServicesClientPackage WindowsMediaPlayer MicrosoftWindowsPowerShellV2Root MicrosoftWindowsPowerShellV2"},{"location":"features/#machinealljson_2","title":"Machine.All.json","text":"<p>Computer level settings for all Windows 10 and above.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct Feature Microsoft-Windows-MediaPlayer-Package*"},{"location":"files/","title":"Files","text":""},{"location":"files/#machineclientjson","title":"Machine.Client.json","text":"<p>Computer level settings for Windows client editions.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct Source Destination apps\\initial_preferences.json C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\initial_preferences"},{"location":"files/#user-windows2025serverjson","title":"User-Windows2025.Server.json","text":"<p>Default user profile settings for Windows Server 2025 and above.</p> Minimum build Maximum build Type 10.0.26100 10.0.99999 DefaultProfile"},{"location":"files/#userclientjson","title":"User.Client.json","text":"<p>Default user profile settings for all Windows client editions</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 DefaultProfile"},{"location":"files/#userserverjson","title":"User.Server.json","text":"<p>Default user profile settings for all Windows Server editions.</p> Minimum build Maximum build Type 10.0.14393 10.0.20348 DefaultProfile"},{"location":"install/","title":"Install Defaults","text":""},{"location":"install/#download-the-latest-release","title":"Download the Latest Release","text":"<p>To use the solution in an operating system deployment pipeline, download the zip file (<code>defaults.zip</code>) attached to the latest release and import the extracted files into your OS deployment solution (e.g., the Microsoft Deployment Toolkit, Microsoft Intune, Microsoft Configuration Manager, etc.).</p> <p></p>"},{"location":"install/#install","title":"Install","text":"<p>Installation of the Windows Enterprise Defaults will depend on where you are running the installation - via the Windows OOBE (1) (with Windows Autopilot or Windows Autopilot device preparation), in an image creation solution, or manually.</p> <ol> <li>Windows OOBE stands for Windows Out-of-Box Experience. It's the setup process that occurs when you turn on a new Windows device for the first time or after resetting it to its factory settings. During OOBE, you're guided through various steps to personalize and configure your device, such as: connecting to a Wi-Fi network, setting up device preferences like region, keyboard layout, and privacy settings, and signing in with a Microsoft account.</li> </ol> <p>Installation is handled with two scripts:</p> <ul> <li><code>Install-Defaults.ps1</code> - this script installs the solution including configuring Windows optimisations and the default user profile</li> <li><code>Remove-AppxApps.ps1</code> - the script removes AppX or Store apps from Windows. This is only called by <code>Install-Defaults.ps1</code> during OOBE, otherwise you will need to run this script directly</li> </ul> <p>If you're deploying the solution via Windows Autopilot, use the following command:</p> <pre><code>C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -ExecutionPolicy RemoteSigned -File .\\Install-Defaults.ps1\n</code></pre> <p>If you're deploying the solution via other tools, e.g. ConfigMgr, MDT or in an image pipeline, run both scripts:</p> <pre><code>.\\Remove-AppxApps.ps1\n.\\Install-Defaults.ps1\n</code></pre>"},{"location":"install/#localising-windows","title":"Localising Windows","text":"<p><code>Install-Defaults.ps1</code> can configure system-wide language / locale settings, and on Windows 10/11 and Windows Server 2025 install language packs. Here's an example installing the English Australia locale settings and language support:</p> <pre><code>.\\Install-Defaults.ps1 -Language \"en-AU\"\n</code></pre> <p>Use <code>Install-Defaults.ps1 -Language \"&lt;language code&gt;\"</code> to install a language pack and set local settings for a specified language. This parameter supports the bcp47 tag of the language to install (e.g., <code>en-AU</code>, <code>en-GB</code>, <code>fr-FR</code>). No locale, regional settings or language packs will be installed unless this parameter is specified.</p> <p>This uses the Install-Language module to install the appropriate language pack. This module is only available on current version of Windows 10, Windows 11 and Windows Server 2025.</p> <p>Note</p> <p>Installation of a language pack on Windows 10 requires a reboot.</p> <p>Additional locale settings can be configured for any version of Windows 10, Windows 11 and Windows Server 2016+ with the <code>International</code> PowerShell module. <code>Install-Defaults.ps1</code> will also configure culture, locale, and language settings using the language value specified in <code>-Language</code>.</p> <p>Below is a summary of the commands used to configure these settings:</p> <pre><code>[System.Globalization.CultureInfo] $Language = \"en-AU\"\nImport-Module -Name \"International\"\nSet-Culture -CultureInfo $Language\nSet-WinSystemLocale -SystemLocale $Language\nSet-WinUILanguageOverride -Language $Language\nSet-WinUserLanguageList -LanguageList $Language.Name -Force\n$RegionInfo = New-Object -TypeName \"System.Globalization.RegionInfo\" -ArgumentList $Language\nSet-WinHomeLocation -GeoId $RegionInfo.GeoId\nSet-SystemPreferredUILanguage -Language $Language\n</code></pre> <p>Warning</p> <p>Run <code>Remove-AppxApps.ps1</code> before using <code>Install-Defaults.ps1</code> to install language packs, otherwise the language pack will be removed.</p>"},{"location":"install/#set-a-time-zone","title":"Set a Time Zone","text":"<p>For Windows 10 and Windows 11, the solution will enable location settings for physical PCs that will automatically se the time zone in most scenarios. However, <code>Install-Defaults.ps1</code> can directly set a time zone when specified on the <code>-TimeZone</code> parameter. Use <code>Install-Defaults.ps1 -TimeZone \"Time zone name\"</code> to set the required time zone.</p> <p>To view the list of valid time zone names to pass to this parameter, use <code>Get-TimeZone -ListAvailable</code>, and use the time zone name on the <code>Id</code> property. Localising Windows and setting the appropriate time zone would look like this:</p> <pre><code>.\\Install-Defaults.ps1 -Language \"en-AU\" -TimeZone \"AUS Eastern Standard Time\"\n</code></pre>"},{"location":"install/#detection","title":"Detection","text":"<p>Once installed, the following registry information can be used to detect that the package is installed:</p> <ul> <li>Key - <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{f38de27b-799e-4c30-8a01-bfdedc622944}</code></li> <li>Value - <code>DisplayVersion</code></li> <li>Data - <code>2211.29.129</code> (the version number of the current release)</li> </ul>"},{"location":"install/#microsoft-intune","title":"Microsoft Intune","text":"<p>The solution is also provided in <code>.intunewin</code> format to enable direct import into Microsoft Intune without re-packaging.</p> <p>Settings for importing the Windows Enterprise Defaults as a Win32 package into Intune are maintained here: App.json. This can be used with the IntuneWin32AppPackager to automate import into Intune.</p> <p></p> <p>To enable support for multiple languages, create multiple Win32 applications with different command lines - one for each required language.</p>"},{"location":"install/#enrollment-status-page","title":"Enrollment Status Page","text":"<p>To ensure the solution applies to a target machine during Windows Autopilot, add the application package to the list of Blocking Apps in the Enrollment Status Page.</p> <p></p>"},{"location":"install/#quick-install","title":"Quick Install","text":"<p>Warning</p> <p>Do not use this method on an existing Windows PC. This script will run <code>Remove-AppxApps.ps1</code> which will remove AppX / Store apps except for the list specified in the script.</p> <p>To simplify download and install during an automated image build pipeline, or to install manually into an image, a quick install script is provided that can be executed with the following PowerShell:</p> <pre><code>Set-ExecutionPolicy Bypass -Scope Process -Force;\n[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072;\nInvoke-Expression ((New-Object System.Net.WebClient).DownloadString(\"https://raw.githubusercontent.com/aaronparker/defaults/main/Install.ps1\"))\n</code></pre> <p>This will download the latest release in zip format, extract the archive and execute <code>Install-Defaults.ps1</code> on the local Windows instance, to install the Windows Enterprise Defaults.</p>"},{"location":"issues/","title":"Known issues","text":""},{"location":"issues/#windows-11-taskbar-cannot-be-customised","title":"Windows 11 Taskbar cannot be customised","text":"<p>Direct customisation of the Windows 11 taskbar isn't possible without sysprepping the image. This means that the taskbar layout for Windows PCs or other static machines customised with this solution, won't have the taskbar customised. It should work on gold images for virtual desktops that are sysprepped after being customised.</p> <p>See Customize the Taskbar for details on the steps required to customise the Windows 11 taskbar.</p>"},{"location":"issues/#language-pack-installs-require-windows-updates","title":"Language pack installs require Windows updates","text":"<p>When using <code>Install-Defaults.ps1</code> to install a language pack, the following errors may be encountered:</p> <pre><code>Install-Language : Language pack or features could only be partially installed. ErrorCode: -2146498159. Please try again.\n</code></pre> <p>and:</p> <pre><code>Set-SystemPreferredUILanguage : Value does not fall within the expected range.\n</code></pre> <p>This occurs even when using a Windows 11 24H2 install from an ISO with recent updates integrated, so this will be difficult to address in Windows Autopilot deployments. When provisioning Windows via Autopilot, deploy language packs (LXPs) directly as an application from Intune.</p> <p>For gold images, ensure the latest Windows Updates are installed before installing the solution.</p> <p>The screenshot below shows this issue when manually running the solution in Windows OOBE.</p> <p></p>"},{"location":"logs/","title":"Logging","text":"<p>Windows Enterprise Defaults logs actions to the following locations:</p> <ul> <li>The default log file path is: <code>C:\\Windows\\Logs\\defaults\\WindowsEnterpriseDefaults.log</code></li> <li>If the target device is enrolled into Microsoft Intune, the log file path will instead be: <code>C:\\ProgramData\\Microsoft\\IntuneManagementExtension\\Logs\\WindowsEnterpriseDefaults.log</code></li> </ul> <p>Data is logged in Configuration Manager format, so it can be viewed with the Support Center Log File Viewer from the Configuration Manager Support Center tools:</p> <p></p>"},{"location":"machine/","title":"Machine settings","text":"<p>Machine specific settings are implemented to configure the local Windows OS with various settings for roles. Settings include:</p>"},{"location":"machine/#all-windows-skus","title":"All Windows SKUs","text":"<ul> <li>Updating some user interface fonts to use <code>Tahoma</code> instead of <code>MS Sans Serif</code>. This purely cosmetic and is implemented to reduce the number of fonts used in the Windows interface. Note that this configuration does not survive <code>sysprep /generalize</code></li> <li>Removes several folders that are typically found in a default Windows install that are not required</li> <li>Adds the <code>DisableEdgeDesktopShortcutCreation</code> setting to prevent Microsoft Edge from placing a shortcut on the desktop - this should no longer be an issue if using a version of Windows with Edge already in the image</li> </ul>"},{"location":"machine/#windows-server","title":"Windows Server","text":"<ul> <li>Enables the Windows Search and Audio services if the Remote Desktop Session Host role is enabled. This uses a specification in the JSON that will enable a list of services, if a specified Windows feature is enabled:</li> </ul> <pre><code>\"Services\": {\n    \"Feature\": \"RDS-RD-Server\",\n    \"Enable\": [\n        \"Audiosrv\",\n        \"WSearch\"\n    ]\n}\n</code></pre>"},{"location":"machine/#windows-10-and-windows-11","title":"Windows 10 and Windows 11","text":"<ul> <li>Disables the following features that are not used on most end-user desktops: <code>Printing-XPSServices-Features</code>, <code>SMB1Protocol</code>, <code>WorkFolders-Client</code>, <code>FaxServicesClientPackage</code>, <code>WindowsMediaPlayer</code>. A set of features to disable can be listed in the JSON as shown below.</li> </ul> <pre><code>\"Features\": {\n        \"Disable\": [\n            \"Printing-XPSServices-Features\",\n            \"SMB1Protocol\",\n            \"WorkFolders-Client\",\n            \"FaxServicesClientPackage\",\n            \"WindowsMediaPlayer\"\n        ]\n    }\n</code></pre> <p><code>WindowsMediaPlayer</code> is included by default with the expectation that you are deploying an alternative, modern media player, such as VLC Player. Removal of the Windows Media Player may affect some media playback features.</p> <ul> <li>Removes the following capabilities that are not used on most enterprise end-user desktops: <code>App.Support.QuickAssist~~~~0.0.1.0</code>, <code>Media.WindowsMediaPlayer~~~~0.0.12.0</code>, <code>XPS.Viewer~~~~0.0.1.0</code>. Capabilities to remove can be listed in the JSON as below:</li> </ul> <pre><code>\"Capabilities\": {\n    \"Remove\": [\n        \"App.Support.QuickAssist~~~~0.0.1.0\",\n        \"Media.WindowsMediaPlayer~~~~0.0.12.0\",\n        \"XPS.Viewer~~~~0.0.1.0\"\n    ]\n}\n</code></pre>"},{"location":"machine/#windows-10-19041-and-above","title":"Windows 10 19041 and above","text":"<p>Windows 10 2004 (10.0.19041) and above will include the following configuration changes:</p> <ul> <li>Removes the following capabilities that are not used on most end-user desktops: <code>Microsoft.Windows.PowerShell.ISE~~~~0.0.1.0</code>, <code>Microsoft.Windows.WordPad~~~~0.0.1.0</code>, <code>Print.Fax.Scan~~~~0.0.1.0</code>, <code>Print.Management.Console~~~~0.0.1.0</code>. Capabilities to remove from a specific Windows build, or higher, can be listed in the JSON as below:</li> </ul> <pre><code>{\n    \"MinimumBuild\": \"10.0.19041\",\n    \"Capabilities\": {\n        \"Remove\": [\n            \"Microsoft.Windows.WordPad~~~~0.0.1.0\",\n            \"Print.Fax.Scan~~~~0.0.1.0\",\n            \"Print.Management.Console~~~~0.0.1.0\"\n        ]\n    }\n}\n</code></pre>"},{"location":"paths/","title":"Removed Paths","text":""},{"location":"paths/#machinealljson","title":"Machine.All.json","text":"<p>Computer level settings for all Windows 10 and above.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct Path C:\\Users\\Public\\Desktop\\Microsoft Edge.lnk C:\\Users\\Public\\Music\\Sample Music C:\\Users\\Public\\Pictures\\Sample Pictures C:\\Users\\Public\\Videos\\Sample Videos C:\\Users\\Public\\Recorded TV\\Sample Media C:\\Logs"},{"location":"profile/","title":"Customise the Default Profile","text":"<p>Customising the default user profile is an important step in configuring the default environment that will user see at first sign-in.</p> <p>Configuring the default profile allows the administrator to reduce noise for the end-user while still allowing them to customise their environment afterwards. This is a better approach that enforcing settings via Group Policy and this will also work for Azure AD joined scenarios.</p> <p>The approach used by these scripts is to make changes directly to the default user profile found at <code>C:\\Users\\Default</code>. When users sign into Windows for the first time, their profile starts as a copy of the default profile, thus it will pick up the customisations.</p>"},{"location":"profile/#all-windows-skus","title":"All Windows SKUs","text":"<p>Imports registry settings into the default profile by mounting the registry file at <code>C:\\Users\\Default\\ntuser.dat</code> and importing a set of registry values that apply to all Windows Server and Windows 10/11 SKUs.</p>"},{"location":"profile/#windows-server","title":"Windows Server","text":"<p>Imports registry settings into the default profile including preventing Server Manager from opening at sign-in, and turning off transparency effects.</p> <p>The script will also import a Start menu and taskbar layout for both Remote Desktop Session Hosts (<code>WindowsRDSStartMenuLayout.xml</code> for Windows Server 2016-2022 or <code>Windows2025RDSStart.bin</code> for Windows Server 2025) and standard infrastructure servers (<code>WindowsServerStartMenuLayout.xml</code>).</p>"},{"location":"profile/#windows-10-or-windows-11","title":"Windows 10 or Windows 11","text":"<p>Imports a Start menu and taskbar layout (<code>Windows10StartMenuLayout.xml</code> or <code>Windows11Start.bin</code>) and add a default configuration file for Microsoft Edge (<code>initial_preferences.json</code>).</p> <p>These settings are imported into the default profile via direct file copies. The source file and destination are defined in the JSON sources as in the examples below. Here Windows 10 and Windows 11 default Start menu and taskbar layouts are defined in the included files and are copied to the specified destination.</p> <pre><code>\"Windows10\": [\n    {\n        \"Source\": \"Windows10StartMenuLayout.xml\",\n        \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.xml\"\n    }\n],\n\"Windows11\": [\n    {\n        \"Source\": \"Windows11StartMenuLayout.json\",\n        \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.json\"\n    },\n    {\n        \"Source\": \"Windows11TaskbarLayout.xml\",\n        \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Microsoft\\\\Windows\\\\Shell\\\\LayoutModification.xml\"\n    },\n    {\n        \"Source\": \"Windows11Start.bin\",\n        \"Destination\": \"C:\\\\Users\\\\Default\\\\AppData\\\\Local\\\\Packages\\\\Microsoft.Windows.StartMenuExperienceHost_cw5n1h2txyewy\\\\LocalState\\\\start.bin\"\n    }\n]\n</code></pre>"},{"location":"profile/#virtual-machines","title":"Virtual Machines","text":"<p>Imports registry settings in the default profile to support Windows running in a virtual machine, typically VDI scenarios. This includes disabling transparency effects, windows animations, and disabling background applications.</p>"},{"location":"registry/","title":"Registry Settings","text":""},{"location":"registry/#machine-w1123h2alljson","title":"Machine-W1123H2.All.json","text":"<p>Computer level settings for Windows 11 21H2 to 23H2.</p> Minimum build Maximum build Type 10.0.22000 10.0.22631 Direct path name value note HKLM: \\Software \\Microsoft \\Windows \\CurrentVersion \\Communications ConfigureChatAutoInstall 0 Prevents the install of the consumer Microsoft Teams client"},{"location":"registry/#machinealljson","title":"Machine.All.json","text":"<p>Computer level settings for all Windows 10 and above.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct path name value note HKLM: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\Explorer DisableEdgeDesktopShortcutCreation 1 Prevents the Microsoft Edge short added to the public desktop HKLM: \\SOFTWARE \\Policies \\Microsoft \\EdgeUpdate CreateDesktopShortcutDefault 0 Prevent the Microsoft Edge shortcut from being added to the desktop HKLM: \\SOFTWARE \\Policies \\Microsoft \\EdgeUpdate RemoveDesktopShortcutDefault 1 Prevent the Microsoft Edge shortcut from being added to the desktop HKLM: \\SOFTWARE \\Policies \\Microsoft \\Edge SearchbarAllowed 0 Prevent the Microsoft Edge search bar from being added to the desktop HKLM: \\SOFTWARE \\Microsoft \\Windows NT \\CurrentVersion \\FontSubstitutes MS Shell Dlg Tahoma Replaces the <code>MS Shell Dlg</code> font with <code>Tahoma</code> for UI consistency HKLM: \\SOFTWARE \\Microsoft \\Windows NT \\CurrentVersion \\FontSubstitutes MS Shell Dlg 2 Tahoma Replaces the <code>MS Shell Dlg 2</code> font with <code>Tahoma</code> for UI consistency HKLM: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\CapabilityAccessManager \\ConsentStore \\location Value Allow Enables location services"},{"location":"registry/#machineclientjson","title":"Machine.Client.json","text":"<p>Computer level settings for Windows client editions.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct path name value note HKLM: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer DisableEdgeDesktopShortcutCreation 1 Prevents the Microsoft Edge short added to the public desktop HKLM: \\Software \\Policies \\Microsoft \\Windows \\CloudContent DisableWindowsConsumerFeatures 1 Disables the Microsoft Windows consumer features HKLM: \\Software \\Policies \\Microsoft \\Windows \\CloudContent DisableCloudOptimizedContent 1 Disables the customisation of the taskbar with additional shortcuts (e.g. new Outlook) <p>Computer level settings for Windows client editions.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct path note HKLM: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\WindowsUpdate \\Orchestrator \\UScheduler_Oobe \\DevHomeUpdate Removes the Dev Home app from the Windows Update Orchestrator to prevent automatic install on Windows 11 HKLM: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\WindowsUpdate \\Orchestrator \\UScheduler \\DevHomeUpdate Removes the Dev Home app from the Windows Update Orchestrator to prevent automatic install on Windows 11 HKLM: \\SOFTWARE \\Microsoft \\WindowsUpdate \\Orchestrator \\UScheduler_Oobe \\DevHomeUpdate Removes the Dev Home app from the Windows Update Orchestrator to prevent automatic install on Windows 11 HKLM: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\WindowsUpdate \\Orchestrator \\UScheduler_Oobe \\OutlookUpdate Removes the Outlook (new) app from the Windows Update Orchestrator to prevent automatic install on Windows 11 HKLM: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\WindowsUpdate \\Orchestrator \\UScheduler \\OutlookUpdate Removes the Outlook (new) app from the Windows Update Orchestrator to prevent automatic install on Windows 11 HKLM: \\SOFTWARE \\Microsoft \\WindowsUpdate \\Orchestrator \\UScheduler_Oobe \\OutlookUpdate Removes the Outlook (new) app from the Windows Update Orchestrator to prevent automatic install on Windows 11 HKLM: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\WindowsUpdate \\Orchestrator \\UScheduler \\MS_Outlook Removes the Outlook (new) app from the Windows Update Orchestrator to prevent automatic install on Windows 10"},{"location":"registry/#servicesclientjson","title":"Services.Client.json","text":"<p>Services settings for Windows client editions</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 Direct path name value note HKLM: \\SYSTEM \\CurrentControlSet \\Services \\tzautoupdate Start 3 Enable Set time zone automatically"},{"location":"registry/#user-windows10alljson","title":"User-Windows10.All.json","text":"<p>Default user profile settings for Windows 10.</p> Minimum build Maximum build Type 10.0.14393 10.0.20999 DefaultProfile path name value note HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Accent AccentColor 4289992518 Sets the accent colour on window title bars and borders HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Accent AccentPalette 86CAFF005FB2F2001E91EA000063B10000427500002D4F000020380000CC6A00 Sets the accent colour on window title bars and borders HKCU: \\Software \\Microsoft \\Windows \\DWM AccentColor 4289815296 Sets the accent colour on window title bars and borders HKCU: \\Software \\Microsoft \\Windows \\DWM ColorizationAfterglow 3288359857 Sets the accent colour on window title bars and borders HKCU: \\Software \\Microsoft \\Windows \\DWM ColorizationColor 3288359857 Sets the accent colour on window title bars and borders"},{"location":"registry/#user-windows11alljson","title":"User-Windows11.All.json","text":"<p>Default user profile settings for Windows 11.</p> Minimum build Maximum build Type 10.0.22000 10.0.29999 DefaultProfile path name value note HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced TaskbarMn 0 Remove the Chat icon from the Taskbar - note: this value should not be needed on Windows 11 23H2 or higher HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced TaskbarDa 0 Remove the Widgets icon from the Taskbar - note: this value is protected by permissions HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Start VisiblePlaces 188 36 138 20 12 214 137 66 160 128 110 217 187 162 72 130 134 8 115 82 170 81 67 66 159 123 39 118 88 70 89 212 Adds 'Settings' and 'File Explorer' next to the power button on the Start menu. HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Start PlacesInitializedVersion 2 Required to support the setting selected for VisiblePlaces. HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced ShowNotificationIcon 1 Enables 'Notifications / Show notification bell icon' HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\AutoInstalledPWAs CopilotPWAPreinstallCompleted 1 Tells Windows that the Copilot PWA has been installed"},{"location":"registry/#user-windows2025serverjson","title":"User-Windows2025.Server.json","text":"<p>Default user profile settings for Windows Server 2025 and above.</p> Minimum build Maximum build Type 10.0.26100 10.0.99999 DefaultProfile path name value note HKCU: \\Software \\Microsoft \\ServerManager DoNotOpenServerManagerAtLogon 1 Prevents Server Manager from starting at login HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Start VisiblePlaces 188 36 138 20 12 214 137 66 160 128 110 217 187 162 72 130 134 8 115 82 170 81 67 66 159 123 39 118 88 70 89 212 Adds 'Settings' and 'File Explorer' next to the power button on the Start menu. HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Start PlacesInitializedVersion 2 Required to support the setting selected for VisiblePlaces."},{"location":"registry/#useralljson","title":"User.All.json","text":"<p>Default user profile settings for all Windows editions</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 DefaultProfile path name value note HKCU: \\Software \\Microsoft \\Windows NT \\CurrentVersion \\Network \\Persistent Connections SaveConnections No Prevents persistent mapped drives in Explorer. Assumes scripts or GPP are used to map network drives HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\AdvertisingInfo Enabled 0 Turns off the feature that lets apps use the advertising ID HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\AppHost EnableWebContentEvaluation 1 Turns on Smart Screen for apps HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\ContentDeliveryManager SystemPaneSuggestionsEnabled 0 Disables app suggestions in the Start menu HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\ContentDeliveryManager SilentInstalledAppsEnabled 0 Disables app suggestions in the Start menu HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Search BingSearchEnabled 0 Disables web search in the Start menu for better responsiveness HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced LaunchTo 1 Configures File Explorer to start on This PC HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced HideFileExt 0 Enables the display of file extensions in File Explorer HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced SeparateProcess 1 Runs File Explorer windows in different processes so that one window crash won't affect all windows HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced TaskbarGlomLevel 1 Configures Taskbar buttons on the primary monitor to combine when the Taskbar is full HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced MMTaskbarGlomLevel 1 Configures Taskbar buttons on secondary monitors to combine when the Taskbar is full HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced Start_IrisRecommendations 0 Remove 'Recommendations for tips, shortcuts, new apps, and more' in the Start menu HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced \\People PeopleBand 0 Removes the People icon from the Taskbar on Windows 10 HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\UserProfileEngagement ScoobeSystemSettingEnabled 0 Disable 'Suggest ways to get the most out of Windows and finish setting up this device' Screen in Settings / System / Notifications HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Search SearchboxTaskbarMode 3 Collapses the Search box into an icon on the Taskbar HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Search SearchboxTaskbarModeCache 3 Required to support the setting selected for SearchboxTaskbarMode HKCU: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\CapabilityAccessManager \\ConsentStore \\location \\NonPackaged Value Allow Enables location services for Win32 applications HKCU: \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\CapabilityAccessManager \\ConsentStore \\location Value Allow Enables location services for Universal Windows Platform Apps HKCU: \\Control Panel \\Accessibility MessageDuration 30 Increase the timeout for new notifications - Dismiss notifications after this amount of time HKCU: \\Software \\Adobe \\Acrobat Reader \\DC \\AVAlert \\cCheckbox iAppDoNotTakePDFOwnershipAtLaunchWin10 1 Prevents the default file type dialog box at Adobe Acrobat Reader DC first launch HKCU: \\Software \\Adobe \\Adobe Acrobat \\DC \\AVAlert \\cCheckbox iAppDoNotTakePDFOwnershipAtLaunchWin10 1 Prevents the default file type dialog box at Adobe Acrobat Pro/Standard DC first launch HKCU: \\Software \\Microsoft \\Windows \\DWM ColorPrevalence 1 Enables 'Show accent colour on title bars and window borders'"},{"location":"registry/#userclientjson","title":"User.Client.json","text":"<p>Default user profile settings for all Windows client editions</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 DefaultProfile path name value note HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Wallpapers BackgroundType 0 Sets the desktop background type to a picture HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\DesktopSpotlight \\Settings EnabledState 0 Disables Windows spotlight HKCU: \\Console \\%%Startup DelegationConsole {2EACA947-7F5F-4CFA-BA87-8F7FBEEFBE69} Sets Windows Terminal as the default terminal HKCU: \\Console \\%%Startup DelegationTerminal {E12CFF52-A866-4C77-9A90-F570A7AA2C6B} Sets Windows Terminal as the default terminal"},{"location":"registry/#userserverjson","title":"User.Server.json","text":"<p>Default user profile settings for all Windows Server editions.</p> Minimum build Maximum build Type 10.0.14393 10.0.20348 DefaultProfile path name value note HKCU: \\Software \\Microsoft \\ServerManager DoNotOpenServerManagerAtLogon 1 Prevents Server Manager from starting at login HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Themes \\Personalize EnableBlurBehind 1 Disable blur for the Start menu, Taskbar and windows HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Search SearchboxTaskbarMode 0 Hides the Search icon on the Taskbar HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced ShowTaskViewButton 0 Removes the Task View button on the Taskbar"},{"location":"registry/#uservirtualjson","title":"User.Virtual.json","text":"<p>Default user profile settings for all Windows editions on virtual machines.</p> Minimum build Maximum build Type 10.0.14393 10.0.99999 DefaultProfile path name value note HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Themes \\Personalize EnableBlurBehind 0 Disable blur for the Start menu, Taskbar and windows HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Themes \\Personalize EnableTransparency 0 Disable transparency for the Start menu, Taskbar and windows HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced IconsOnly 1 Show icons only and not document previews HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced ListviewAlphaSelect 0 Disables the translucent selection rectangle in File Explorer HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced ListviewShadow 0 Disables drop shadows on icons in File Explorer HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced ShowCompColor 1 Changes the font colour for compressed NTFS files / directories HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced ShowInfoTip 1 Disables tooltips in File Explorer HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\Explorer \\Advanced TaskbarAnimations 0 Disables animations in the Taskbar HKCU: \\Software \\Microsoft \\Windows \\DWM EnableAeroPeek 0 Disables Peek at desktop and Taskbar thumbnail live previews HKCU: \\Software \\Microsoft \\Windows \\DWM AlwaysHibernateThumbnails 0 Disables Taskbar preview thumbnail cache HKCU: \\Control Panel \\Desktop DragFullWindows 1 Disables the display of the window contents when dragging HKCU: \\Control Panel \\Desktop \\WindowMetrics MinAnimate 0 Disables animations for minimise and maximise actions for windows HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\ContentDeliveryManager SubscribedContent-338393Enabled 0 Disables suggested content in the Settings app HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\ContentDeliveryManager SubscribedContent-353694Enabled 0 Disables suggested content in the Settings app HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\ContentDeliveryManager SubscribedContent-353696Enabled 0 Disables suggested content in the Settings app HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\ContentDeliveryManager SubscribedContent-338388Enabled 0 Disables suggested content in the Settings app HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\ContentDeliveryManager SubscribedContent-338389Enabled 0 Disables suggested content in the Settings app HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\ContentDeliveryManager SubscribedContent-310093Enabled 0 Disables 'Show me the Windows welcome experience after updates and occasionally when I sign in to highlight what's new and suggested' HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\BackgroundAccessApplications \\Microsoft.Windows.Photos_8wekyb3d8bbwe Disabled 1 Prevents the Photos app from running in the background HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\BackgroundAccessApplications \\Microsoft.Windows.Photos_8wekyb3d8bbwe DisabledByUser 1 Prevents the Photos app from running in the background HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\BackgroundAccessApplications \\Microsoft.YourPhone_8wekyb3d8bbwe Disabled 1 Prevents the Your Phone app from running in the background HKCU: \\Software \\Microsoft \\Windows \\CurrentVersion \\BackgroundAccessApplications \\Microsoft.YourPhone_8wekyb3d8bbwe DisabledByUser 1 Prevents the Your Phone app from running in the background"},{"location":"results/","title":"Results","text":"<p>Windows Enterprise Defaults will configure the Windows image ready for the enterprise and an improved end-user experience.</p> <p>Here's the default Windows 11 desktop with many of the in-box applications pinned to the Start menu, Windows spotlight set as the default wallpaper, Microsoft Edge web search box on the desktop, and Microsoft Copilot and the Microsoft Store pinned to the taskbar.</p> <p></p> <p>And here's a Windows 11 desktop after customisation - note that regional settings are configured, there's default Start menu, the search box in the taskbar has been reduced in size, many of the in-box applications have been uninstalled, and the default wallpaper has been set back to the Windows 11 bloom wallpaper (instead of Windows spotlight).</p> <p></p> <p>When used in provisioning devices with Windows Autopilot, other deployment tools, or with a VDI solution or Windows 365, and combined with Intune policies or Group Policy settings, the default user desktop should then be similar to the following screenshot from a Windows PC.</p> <p></p> <p>Here's another example of an optimised single-session Windows 11 desktop accessed via Azure Virtual Desktop:</p> <p></p> <p>Windows Enterprise Defaults also supports Windows Server Remote Desktop session hosts - here's the default desktop on Windows Server 2025 after customisation.</p> <p></p>"},{"location":"services/","title":"Services","text":""},{"location":"services/#machineserverjson","title":"Machine.Server.json","text":"<p>Computer level settings for Windows Server editions.</p> Minimum build Maximum build 10.0.14393 10.0.99999 Service Audiosrv WSearch"}]}